# Predicting-Accident-Injuries-Using-XGBoost-A-Binary-Classification-Approach
Problem Statement:

Injury prediction is a vital area of study because it has the potential to enhance road safety and can allow emergency responders to allocate resources efficiently. Knowing that an accident could result in an injury or not can prompt a faster and more robust response, which can potentially save millions of lives. A machine learning model can play a vital role here because it can predict the likelihood of injury in an accident which can help emergency responders prioritize their resources and actions, ensuring that the most critical cases receive immediate attention. This means directing medical personnel, ambulances, and other resources to where they are needed the most, reducing wastage of resources and unnecessary costs associated with over-deployment of resources where there is no accident. The need for such a model came into my mind looking at the recent floods in the United Arab Emirates, which led to significant traffic disruptions and numerous accidents.

The UAE lacked data points with respect to injuries which led to poor resource allocation. Under allocation of resources led to severe chaos among the public stuck on roads throughout the affected areas. This prompted me to seek a dataset on Kaggle that includes UAE traffic accident information with attributes like weather, surface conditions, road type, and other relevant features. Based on these attributes I created a model that can predict whether an accident will result in injury or not. By accurately predicting injury occurrences, my model can help first responders implement preventive measures, allocate resources efficiently, and ultimately save lives. Furthermore, this model can assist governments and insurance companies in determining the necessity of dispatching ambulances or additional resources, thus optimizing response efforts and resource utilization.


Data Overview and Data Preparation: 

The dataset was sourced from Kaggle which contained traffic accident records from Abu Dhabi since 2016 to 2020. Initially, the dataset primarily consisted of Arabic text, which required translation into English using Google Translate. Due to inaccuracies in translation, manual replacements were conducted. Afterward, white spaces were removed from both rows and columns for cleanliness in the data presentation. To ensure data reliability, the types of data and missing values were inspected. This inspection revealed that there were no missing values, but most of the columns were categorical (string).

We know that many machine learning algorithms require numerical input, which is why I performed Label encoding and one hot encoding on the categorical variables to make them into numerical format. Label encoding was performed on the target variable ‘Rep Kind’, where ‘Traffic accident with injuries’ was encoded as 1, and the ‘'Traffic accident without injuries’ as 0. Following this, the dataset was split into independent variables ‘City’, ‘Street’, ‘Rep_Type’, ‘Reason’, ‘Surface’, ‘Weather’, and ‘Age’ into X. And the dependent variable ‘Rep Kind’ is to be predicted (y). Later one one-hot encoding was applied to categorical features within X. This sophisticated conversion on X and y will allow my chosen algorithm to learn the relationships between categories more effectively, that will potentially lead me sto better predictions.

Furthermore, I noted that only 0.74% of the dataset instances related to traffic accidents resulted in injuries, indicating a class imbalance. To address this issue, I took the help of the stratify parameter in the train-test split function because this parameter ensures that the proportion of classes in the train and test datasets is approximately the same as the proportion in the original dataset. Keeping this in mind the data was stratified during the splitting process into training and testing sets using (y) predicted variable, maintaining the same percentage of injury cases across both subsets.


Modeling: 

To predict whether an accident will result in an injury, I employed an XGBoost binary classification model. I went with the XGboost model because it is designed to handle and understand the complex patterns and interactions of data through its robust ensemble learning method. XGboost combines multiple weak learners to form a strong predictive model. In addition to that one of the key strengths of XGBoost is to incorporate techniques like the ‘scale_pos_weight ‘parameter, which adjusts the balance of positive and negative weights to improve model performance on minority classes. 

I built the model using basic hyperparameters; like learning rate of 0.1, a maximum tree depth of 6, and 100 estimators. The initial model was trained on the training set and evaluated on the test set using the 'aucpr' metric. I went forward with the area under the precision-recall curve (AUCPR) metric because it focuses on precision (positive predictive value) and recall (number of positive instances correctly identified by the model). By using AUCPR, I will be able to ensure that the model performs well in identifying the minority class, reducing the likelihood of false alarms and missed detections. Identification of false alarms is crucial in my case because I do not want my model to make false negative predictions which means when there is an injury in the accident my model should not be predicting not injured.


Evaluation:

The initial model achieved an accuracy of 99.4%, a precision of 0.8, and a recall of 0.22. While these results seemed promising at first glance, a closer inspection of the confusion matrix reveals that out of 2481 people, 2427 who were not injured in an accident were correctly classified (99.4%). And out of 18 people who were injured in the accident, only 4 people were correctly classified (22.2%), and 14 people were classified wrong by my model, which tells me that false negative is high. The high false negative rate indicated that the model was failing to adequately identify injury cases, which is critical in this context as it can endanger lives by failing to notify medical personnel of actual injuries.

Recognizing the imbalanced nature of the dataset, with only 18 injury cases out of 2481 total samples, I adjusted the 'scale_pos_weight' parameter to 132 to penalize the misclassification of the minority class (injury cases). To further refine the model, I performed hyperparameter optimization using GridSearchCV, testing various combinations of parameters such as 'max_depth', 'learning_rate', 'gamma', and 'reg_lambda'. This process aimed to enhance the model's ability to correctly classify injury cases while maintaining overall performance.

The optimized model, configured with parameters including a learning rate of 0.1, a maximum depth of 8, a 'gamma' value of 0.09, and a 'scale_pos_weight' of 132, showed substantial improvement. The refined model achieved an accuracy of 95.6%, a precision of 0.12, and a recall of 0.83. The confusion matrix indicated that 2374 out of 2481 non-injury cases (95.6%) were correctly classified, and 15 out of 18 injury cases (83.3%) were accurately identified. This reduction in false negatives from 14 to 3 demonstrates that the model now effectively identifies injury cases, which is crucial for timely medical response. Although the overall accuracy decreased slightly, this trade-off is justified as the primary goal is to minimize false negatives. This adjustment ensures that the model reliably alerts medical personnel to injury cases, thereby improving the practical applicability and safety outcomes of the prediction system.





Conclusion: 

This project embarks on my overall journey that starts with identifying a critical problem in traffic accident injury prediction. My model solution has the potential to revolutionize resource allocation for first responders by letting them know the injured condition of a traffic accident. By accurately translating and preprocessing the dataset from Arabic to English, I ensured the reliability and quality of inputs, which laid a strong foundation for model development. Leveraging the XGBoost algorithm, I tackled the essential class imbalance in the data by employing advanced techniques such as stratification and tuning the 'scale_pos_weight' parameter. The iterative process of hyperparameter optimization through GridSearchCV significantly improved the model's ability to accurately identify injury cases, reducing the false negatives dramatically. This enhancement ensured that the model effectively alerts medical personnel to real injury situations, thereby optimizing emergency response efforts. The refined model's balance between accuracy and recall demonstrates a strategic approach to enhancing road safety and resource efficiency, underscoring the practical utility and lifesaving potential of this predictive system.
![image](https://github.com/rkumania/Predicting-Accident-Injuries-Using-XGBoost-A-Binary-Classification-Approach/assets/53499747/d61dd3a8-9e94-4ca5-9219-b505b77722e6)
